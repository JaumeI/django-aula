{% extends "base.html" %}

{% block head %}
  {{ head }}

{% endblock %}

{% block content  %}
    <h1>Llista de tots els SMS</h1>
    <div class="row row-padded">
        <div class="col-sm-3"></div><!-- no funciona bé el col-offset-6"-->
        <div class="col-sm-8">
            <!--div data-toggle="buttons-radio"-->
            <div class="btn-group">
                <button type="button" id="totenviar" class="btn btn-default btn-info">enviar</button>
                <button type="button" id="totanular" class="btn btn-default btn-info">anular</button>
                <button type="button" id="totres" class="btn btn-default btn-info">res</button>
            </div>

        </div>
    </div>


    {% if formset %}
        <div class="clearfix"></div>
        <br/>
    <form action="" class="inline-form" method="POST">{% csrf_token %}
        {{ formset.management_form }}
    {% for form in formset %}

        <div class="row row-padded" style="background-color:{% cycle '#f5f5f5' 'white' %}">
        <div class="col-lg-3" style="line-height: 34px; vertical-align: middle;"> {{ form.instance.alumne }}</div>
        {{ form.id }}
        {% for field in form.visible_fields %}
	        <div class=" col-lg-3 col-sm-8 col-xs-12">
                {{ field }}
		        {% if field.errors %}
			        <div class="alert alert-danger">
			        <button type="button" class="close" data-dismiss="alert">&times;</button>
				        <ul>
				          {% for error in field.errors%}
				          <li>{{ error }}</li>
			              {% endfor %}
			            </ul>
		         	</div>
		        {% endif %}
	        </div>
        {% endfor %}
        {% if form.instance.intents != 0 %}
            <div class="col-lg-4" style="color:red;"> Número d'intents erronis: {{ form.instance.intents }}</div>
        {% endif %}

        </div>
    {% empty %}
        <h2>No hi han SMS pendents d'enviar.</h2>
    {% endfor %}
        <div class="clearfix"></div>
        <br/>
        <button class="btn btn-lg btn-info">ENVIA</button>
        </form>
    {% endif %}

{% endblock %}

{% block extrahead %}
<script>
$(document).ready(function() {
    /**Actualitzar classes dels botons**/
    $('.btn-group .btn').click(function() {
        $(this).siblings().removeClass('btn-success btn-warning');
    });
    $('.btnenviar').click(function() {
       $(this).addClass('btn-success');
    });
    $('.btnanular').click(function() {
       $(this).addClass('btn-warning');
    });
    $('.btn-group .active').trigger('click');


    //Fer funcionar botons superiors
    $('#totenviar').click(function() {
        $('.btnenviar').trigger('click');
    });
    $('#totanular').click(function() {
        $('.btnanular').trigger('click');
    });
    $('#totres').click(function() {
        $('.btnres').trigger('click');
    });

});
</script>



{% endblock %}

